<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kinetic Forged Fitness</title>
  <link rel="stylesheet" href="index.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script type="importmap">
    {
      "imports": {
        "@google/genai": "https://esm.sh/@google/genai@^0.12.0"
      }
    }
  </script>
</head>
<body>
  <!-- App Container -->
  <div id="app-container">
    <header>
      <div class="nav-and-user">
        <div class="header-title-wrapper">
          <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M16.721 2.454a1 1 0 0 1 .454 1.29l-3.238 9.066a1.5 1.5 0 0 0 .524 1.636l2.4 1.8a1 1 0 0 1-1.2 1.6l-2.4-1.8a1.5 1.5 0 0 0-1.636-.524l-9.066 3.238a1 1 0 0 1-1.29-.454l-1.789-3.219a1 1 0 0 1 .454-1.29l9.066-3.238a1.5 1.5 0 0 0 .524-1.636l-1.8-2.4a1 1 0 0 1 1.6-1.2l1.8 2.4a1.5 1.5 0 0 0 1.636.524l3.238-9.066a1 1 0 0 1 1.29-.454zM21.5 1.5a1 1 0 0 1 .958 1.288l-2.121 5.938a1 1 0 0 1-1.288.53l-2.268-.81a1 1 0 0 1-.53-1.288l2.12-5.938a1 1 0 0 1 1.288-.53l1.83.652zM12 21a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"></path></svg>
          <h1 class="header-title">Kinetic Forged Fitness</h1>
        </div>
        <nav id="main-nav">
          <button class="nav-tab active" data-tab="training">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M21.583 8.337l-4.243 4.243-4.243-4.243-4.243 4.243-4.243-4.243L2.417 10.5l4.243 4.243-4.243 4.243 2.163 2.163 4.243-4.243 4.243 4.243 4.243-4.243 4.243 4.243 2.163-2.163-4.243-4.243 4.243-4.243-2.163-2.163zM12 3a1 1 0 0 1 .707.293l4.243 4.243a1 1 0 0 1-1.414 1.414L12 5.414l-3.536 3.536a1 1 0 0 1-1.414-1.414L11.293 3.293A1 1 0 0 1 12 3z"></path></svg>
            <span>Training</span>
          </button>
          <button class="nav-tab" data-tab="workout">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12.75 3h-1.5L8 7.5l-1.5 1.5H4a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2.5L8 14.5l3.25 4.5h1.5l3.25-4.5L17.5 13H20a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-2.5L16 7.5 12.75 3zm-1.833 9H13.08l.5-1.5H12l-.5 1.5zm-2.084 0H8.333l.5-1.5h1.583l-.5 1.5zm-2.083-3l.5-1.5h1.583l-.5 1.5H6.75zm10.5 0h-1.583l-.5-1.5h1.583l.5 1.5zm2.083-3l-.5-1.5h-1.583l.5 1.5H19.25zM12 7.25L11.5 8.75h1L12 7.25z"></path></svg>
            <span>Workout</span>
          </button>
          <button class="nav-tab" data-tab="history">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm4.3 14.3a.998.998 0 0 1-1.414 0L11 12.414V7a1 1 0 0 1 2 0v4.586l3.3 3.3a.998.998 0 0 1 0 1.414z"></path></svg>
            <span>History</span>
          </button>
          <button class="nav-tab" data-tab="library">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M4 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H4zm1 3h14v14H5V5zM7 7v2h10V7H7zm0 4v2h10v-2H7zm0 4v2h7v-2H7z"></path></svg>
            <span>Library</span>
          </button>
          <button class="nav-tab" data-tab="profile">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 3a3 3 0 1 1-3 3 3 3 0 0 1 3-3zm0 14.2a7.2 7.2 0 0 1-6-3.22c.03-1.98 4-3.08 6-3.08s5.97 1.1 6 3.08a7.2 7.2 0 0 1-6 3.22z"></path></svg>
            <span>Profile</span>
          </button>
        </nav>
      </div>
    </header>
    <main>
      <!-- Training Screen -->
      <div id="training-screen" class="screen">
        <div id="todays-training-wrapper">
          <!-- JS will populate this with today's workout or a placeholder -->
        </div>
         <div id="training-calendar-container" class="library-section">
          <h3>Training Calendar</h3>
          <div class="calendar-header">
            <button id="prev-month-btn" class="btn-tertiary btn-icon" aria-label="Previous month"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/></svg></button>
            <h4 id="calendar-month-year"></h4>
            <button id="next-month-btn" class="btn-tertiary btn-icon" aria-label="Next month"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/></svg></button>
          </div>
          <div id="calendar-grid-header">
            <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
          </div>
          <div id="calendar-grid"></div>
        </div>
      </div>
      
      <!-- Workout Screen -->
      <div id="workout-screen" class="screen hidden">
          <div id="workout-plan" class="hidden">
              <h2 id="workout-title"></h2>
              <div id="exercises-container"></div>
              <button id="finish-workout-btn">Finish Workout</button>
          </div>
          <div id="no-active-workout" class="placeholder-section">
              <h2>No Active Workout</h2>
              <p>Start a workout from your Training schedule or the Library to begin.</p>
          </div>
      </div>

      <!-- History Screen -->
      <div id="history-screen" class="screen hidden">
          <h2>Workout History</h2>
          <div class="stats-card">
              <h3>Total Workouts Completed</h3>
              <p id="workouts-completed-stat">0</p>
          </div>
          <div id="completed-workouts-list-container" class="library-section">
            <h3>Completed Sessions</h3>
            <div id="completed-workouts-list">
                <!-- JS will populate this list of completed workouts -->
            </div>
          </div>
      </div>

      <!-- Library Screen -->
      <div id="library-screen" class="screen hidden">
        <div class="library-section-wrapper">
            <div class="library-section">
                <h3>Your Custom Programs</h3>
                <p>Create and manage your own workout routines.</p>
                <button id="create-new-program-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2h6z"></path></svg>
                    <span>Create New Program</span>
                </button>
                <div id="custom-programs-container">
                  <!-- User-created programs will be listed here -->
                </div>
            </div>
        </div>
        <div class="library-section-wrapper">
            <div class="library-section">
              <h3>Discover Programs</h3>
              <p>Need inspiration? Generate program ideas or a full multi-week plan from our AI coach.</p>
              <button id="discover-programs-btn">Get Quick Ideas</button>
              <div id="program-ideas-loader" class="hidden">
                  <div class="spinner"></div>
              </div>
              <div id="program-ideas-container"></div>
              <hr>
              <form id="generate-from-idea-form" class="generate-from-idea-form">
                <h4>Generate a Program from Your Idea</h4>
                <p class="form-info">Describe your goal, desired duration, and any other specifics. The AI will create a tailored plan for you.</p>
                <div class="form-group">
                  <textarea id="program-idea-input" name="program-idea-input" rows="4" placeholder="e.g., An 8-week program to improve my golf swing power."></textarea>
                </div>
                <button type="submit" id="generate-from-idea-btn">Generate My Program</button>
              </form>
            </div>
        </div>
      </div>

      <!-- Profile Screen -->
      <div id="profile-screen" class="screen hidden">
        <h2>Your Profile</h2>
        <form id="profile-form">
          <div class="form-group">
            <label for="name">Name</label>
            <input type="text" id="name" name="name" placeholder="Enter your name" autocomplete="name">
          </div>
          <div class="form-group-inline">
              <div class="form-group">
                  <label for="age">Age</label>
                  <input type="number" id="age" name="age" placeholder="e.g., 25">
              </div>
              <div class="form-group">
                  <label for="weight">Weight (lbs)</label>
                  <input type="number" id="weight" name="weight" step="0.1" placeholder="e.g., 155">
              </div>
              <div class="form-group">
                  <label for="height">Height (cm)</label>
                  <input type="number" id="height" name="height" placeholder="e.g., 180">
              </div>
          </div>
          <div class="form-group">
            <label>Weight Unit</label>
            <div class="unit-selector">
                <input type="radio" id="unit-lbs" name="weight-unit" value="lbs" checked><label for="unit-lbs">lbs</label>
                <input type="radio" id="unit-kg" name="weight-unit" value="kg"><label for="unit-kg">kg</label>
            </div>
          </div>
          <div class="form-group">
            <label for="profile-goal">Primary Goal</label>
            <select id="profile-goal" name="goal">
              <option value="muscle-gain">Muscle Gain</option>
              <option value="fat-loss">Fat Loss</option>
              <option value="strength">Strength</option>
              <option value="general-fitness">General Fitness</option>
              <option value="endurance">Endurance</option>
            </select>
          </div>
          <p class="saved-feedback hidden">Profile Saved!</p>
        </form>
      </div>

      <div id="loader" class="hidden">
        <div class="spinner"></div>
        <p>Generating your personalized workout...</p>
      </div>
    </main>
    
    <!-- Create Program Modal -->
    <div id="create-program-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <button class="modal-close-btn btn-icon" aria-label="Close">&times;</button>
        <h2>Create a New Workout Program</h2>
        <form id="create-program-form">
          <div class="form-group">
            <label for="workout-file-upload">AI Assist: Upload a Workout File</label>
             <div class="file-upload-wrapper">
              <input type="file" id="workout-file-upload" name="workout-file-upload" accept=".txt,.pdf,.md">
              <button type="button" id="analyze-file-btn" class="btn-tertiary">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12.914 2.828a2 2 0 0 0-1.414-.586H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8.343a2 2 0 0 0-.586-1.414l-4.5-4.5zM14 9h-4V5l4 4zm-1 9-2-2.5-1.5 1.5L6 14l-3 4h14l-4-5z"></path></svg>
                <span>Analyze & Fill Form</span>
              </button>
            </div>
            <div id="file-analysis-loader" class="hidden">
              <div class="spinner"></div>
              <span>Analyzing your document... this may take a moment.</span>
            </div>
          </div>
          <hr>
          <div class="form-group">
            <label for="program-name">Program Name</label>
            <input type="text" id="program-name" name="program-name" required placeholder="e.g., 8-Week Strength Builder">
          </div>
          <div class="form-group">
            <label for="program-description">Description</label>
            <textarea id="program-description" name="program-description" rows="3" placeholder="Describe the main goal of this program"></textarea>
          </div>
          <hr>
          <h3>Workouts</h3>
          <div id="program-workouts-container">
            <!-- Workouts will be dynamically added here -->
          </div>
          <button type="button" id="add-workout-btn" class="btn-secondary">Add Workout Day</button>
          <hr>
          <div class="modal-actions">
            <button type="submit" id="save-program-btn">Save Program</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Schedule Program Modal -->
    <div id="schedule-program-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <button class="modal-close-btn btn-icon" aria-label="Close">&times;</button>
        <h2 id="schedule-modal-title">Schedule Program</h2>
        <form id="schedule-program-form">
          <div class="schedule-form-layout">
            <div class="form-group">
              <label>Program Start Date</label>
              <!-- This input is now hidden and will be populated by the mini-calendar -->
              <input type="hidden" id="schedule-start-date" name="schedule-start-date" required>
              <div class="schedule-calendar-wrapper">
                <div class="schedule-calendar-header">
                  <button type="button" id="schedule-prev-month-btn" class="btn-tertiary btn-icon" aria-label="Previous month">&lt;</button>
                  <h4 id="schedule-calendar-month-year"></h4>
                  <button type="button" id="schedule-next-month-btn" class="btn-tertiary btn-icon" aria-label="Next month">&gt;</button>
                </div>
                <div id="schedule-calendar-grid-header">
                  <div>S</div><div>M</div><div>T</div><div>W</div><div>T</div><div>F</div><div>S</div>
                </div>
                <div id="schedule-calendar-grid"></div>
              </div>
            </div>
            <div class="form-group">
                <label>Schedule on Days:</label>
                <p class="form-info">Select the days of the week you want to perform the workouts. The program will be scheduled sequentially on these days starting from your chosen date.</p>
                <div class="day-selector">
                    <input type="checkbox" id="day-sun" name="schedule-day" value="0"><label for="day-sun">Sun</label>
                    <input type="checkbox" id="day-mon" name="schedule-day" value="1" checked><label for="day-mon">Mon</label>
                    <input type="checkbox" id="day-tue" name="schedule-day" value="2"><label for="day-tue">Tue</label>
                    <input type="checkbox" id="day-wed" name="schedule-day" value="3" checked><label for="day-wed">Wed</label>
                    <input type="checkbox" id="day-thu" name="schedule-day" value="4"><label for="day-thu">Thu</label>
                    <input type="checkbox" id="day-fri" name="schedule-day" value="5" checked><label for="day-fri">Fri</label>
                    <input type="checkbox" id="day-sat" name="schedule-day" value="6"><label for="day-sat">Sat</label>
                </div>
            </div>
          </div>
          <div class="modal-actions">
            <button type="submit" id="save-schedule-btn">Save Schedule</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Program Details Modal -->
    <div id="program-details-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <button class="modal-close-btn btn-icon" aria-label="Close">&times;</button>
        <h2 id="details-modal-title">Program Details</h2>
        <p id="details-modal-description"></p>
        <hr>
        <h3>Workouts</h3>
        <div id="details-modal-workouts-container">
          <!-- Generated workouts will be displayed here -->
        </div>
        <hr>
        <div class="modal-actions">
          <button type="button" id="save-discovered-program-btn">Save to My Library</button>
        </div>
      </div>
    </div>
    
      <!-- Workout Overview Modal -->
    <div id="workout-overview-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <button class="modal-close-btn btn-icon" aria-label="Close">&times;</button>
        <h2 id="overview-modal-title">Workout Overview</h2>
        <div id="overview-modal-content" class="details-modal-workouts-container">
          <!-- JS will populate this -->
        </div>
        <div class="modal-actions">
          <button type="button" id="overview-modal-start-btn">Start This Workout</button>
        </div>
      </div>
    </div>

    <!-- Post-Workout Feedback Modal -->
    <div id="post-workout-feedback-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <button class="modal-close-btn btn-icon" aria-label="Close">&times;</button>
        <h2>Workout Complete!</h2>
        <p>How did that feel? Rate your workout and add any notes.</p>
        <form id="post-workout-feedback-form">
          <div class="form-group">
            <label for="workout-intensity">Perceived Intensity (1: Very Easy - 10: Max Effort)</label>
            <div class="intensity-selector">
              <input type="radio" id="intensity-1" name="intensity" value="1" required><label for="intensity-1">1</label>
              <input type="radio" id="intensity-2" name="intensity" value="2"><label for="intensity-2">2</label>
              <input type="radio" id="intensity-3" name="intensity" value="3"><label for="intensity-3">3</label>
              <input type="radio" id="intensity-4" name="intensity" value="4"><label for="intensity-4">4</label>
              <input type="radio" id="intensity-5" name="intensity" value="5"><label for="intensity-5">5</label>
              <input type="radio" id="intensity-6" name="intensity" value="6"><label for="intensity-6">6</label>
              <input type="radio" id="intensity-7" name="intensity" value="7"><label for="intensity-7">7</label>
              <input type="radio" id="intensity-8" name="intensity" value="8"><label for="intensity-8">8</label>
              <input type="radio" id="intensity-9" name="intensity" value="9"><label for="intensity-9">9</label>
              <input type="radio" id="intensity-10" name="intensity" value="10"><label for="intensity-10">10</label>
            </div>
          </div>
          <div class="form-group">
            <label for="workout-notes">Workout Notes</label>
            <textarea id="workout-notes" name="workout-notes" rows="4" placeholder="e.g., Felt strong on squats, wrist felt a bit tweaky on press..."></textarea>
          </div>
          <div class="modal-actions">
            <button type="submit" id="save-feedback-btn">Save & Finish</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Workout History Modal -->
    <div id="workout-history-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <button class="modal-close-btn btn-icon" aria-label="Close">&times;</button>
        <h2 id="history-modal-title">Workout Details</h2>
        <div class="history-modal-meta">
            <p id="history-modal-date"></p>
            <p id="history-modal-intensity"></p>
        </div>
        <div class="history-modal-notes">
            <h4>Notes</h4>
            <p id="history-modal-notes"></p>
        </div>
        <hr>
        <h3>Performance Log</h3>
        <div id="history-modal-exercises-container" class="details-modal-workouts-container">
          <!-- JS will populate exercises and performance tables here -->
        </div>
      </div>
    </div>


    <!-- Templates for Dynamic Form -->
    <template id="workout-block-template">
        <div class="workout-block">
            <button type="button" class="remove-btn remove-workout-btn btn-icon" aria-label="Remove workout day">&times;</button>
            <div class="form-group">
                <label>Workout Day Name</label>
                <input type="text" class="workout-name-input" required placeholder="e.g., Day 1: Push Day">
            </div>
            <h4>Exercises</h4>
            <div class="workout-exercises-container">
                <!-- Exercises will be dynamically added here -->
            </div>
            <button type="button" class="add-exercise-btn btn-tertiary">Add Exercise</button>
        </div>
    </template>

    <template id="exercise-block-template">
        <div class="exercise-block">
            <input type="text" class="exercise-name-input" placeholder="Exercise Name" required>
            <input type="number" class="exercise-sets-input" placeholder="Sets" required>
            <div class="metric-input-group">
              <input type="text" class="exercise-metric-input" placeholder="e.g., 10-12 or 500" required>
              <select class="exercise-unit-select">
                  <option value="reps">reps</option>
                  <option value="seconds">seconds</option>
                  <option value="meters">meters</option>
                  <option value="feet">feet</option>
                  <option value="yards">yards</option>
                  <option value="miles">miles</option>
              </select>
            </div>
            <textarea class="exercise-description-input" placeholder="Description (optional)" rows="1"></textarea>
            <button type="button" class="remove-btn remove-exercise-btn btn-icon" aria-label="Remove exercise">&times;</button>
        </div>
    </template>
  </div>

  <script type="module" src="index.tsx"></script>
</body>
</html>